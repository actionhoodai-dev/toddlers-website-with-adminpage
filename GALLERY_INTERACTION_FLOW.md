# GALLERY MANAGER - INTERACTION FLOW

## ðŸ“¸ New User Experience

### DEFAULT MODE (Normal View)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gallery Manager                      [Select Multiple] [Upload New] [Dashboard]  â”‚
â”‚  Total: 12 images                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  ðŸ“ therapy (4 images)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”                      â”‚
â”‚  â”‚ ðŸ“· â”‚  â”‚ ðŸ“· â”‚  â”‚ ðŸ“· â”‚  â”‚ ðŸ“· â”‚  â† Click = PREVIEW    â”‚
â”‚  â”‚img1â”‚  â”‚img2â”‚  â”‚img3â”‚  â”‚img4â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                          â”‚
â”‚  ðŸ“ facilities (3 images)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ ðŸ“· â”‚  â”‚ ðŸ“· â”‚  â”‚ ðŸ“· â”‚  â† Click = PREVIEW            â”‚
â”‚  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CLICK IMAGE â†’ Opens Preview/Edit Modal âœ…
```

---

### PREVIEW/EDIT MODAL
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edit Image                                    [âœ•]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Title: [Updated Title_______]     â”‚
â”‚  â”‚              â”‚                                         â”‚
â”‚  â”‚   [IMAGE]    â”‚    Description:                        â”‚
â”‚  â”‚              â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              â”‚    â”‚ Updated description text... â”‚  â”‚
â”‚  â”‚              â”‚    â”‚                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Uploaded: 1/18/26   Category: [Therapy â–¼]            â”‚
â”‚                                                          â”‚
â”‚  [Save Changes]  [Delete Image]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ACTION: Edit metadata, then "Save Changes" â†’ UPDATE âœ…
ACTION: "Delete Image" â†’ DELETE + Storage cleanup âœ…
```

---

### SELECT MODE (Bulk Operations)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gallery Manager   [Cancel Selection] [Delete Selected (3)] [Select All]  â”‚
â”‚  Total: 12 images                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  ðŸ“ therapy (4 images)                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”                      â”‚
â”‚  â”‚â˜‘ï¸ðŸ“·â”‚  â”‚â˜ðŸ“·â”‚  â”‚â˜‘ï¸ðŸ“·â”‚  â”‚â˜‘ï¸ðŸ“·â”‚  â† Click = SELECT    â”‚
â”‚  â”‚img1â”‚  â”‚img2â”‚  â”‚img3â”‚  â”‚img4â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜                      â”‚
â”‚   âœ…      ---      âœ…      âœ…                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CLICK IMAGE â†’ Toggles checkbox âœ…
CLICK "Delete Selected" â†’ Bulk delete with storage cleanup âœ…
```

---

## ðŸ”„ State Transitions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEFAULT MODE  â”‚ â† User lands here
â”‚ (Preview)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Click "Select Multiple" button
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SELECT MODE  â”‚
â”‚ (Checkboxes)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Click "Cancel Selection" or after bulk delete
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEFAULT MODE  â”‚
â”‚ (Preview)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŽ¯ Key Features

### DEFAULT MODE:
- âœ… **Click image** â†’ Opens preview/edit modal
- âœ… No checkboxes visible
- âœ… Clean, simple interface
- âœ… Can edit individual image metadata
- âœ… Can delete individual image

### SELECT MODE:
- âœ… **Click image** â†’ Toggles selection (checkbox)
- âœ… Checkboxes visible on all images
- âœ… "Select All" / "Deselect All" buttons
- âœ… "Delete Selected (X)" button appears when images selected
- âœ… Bulk delete with confirmation
- âœ… Auto-exits to default mode after delete

---

## ðŸ› ï¸ Implementation Details

### Click Handler Logic:
```typescript
onClick={() => {
  if (selectMode) {
    // In select mode: toggle checkbox
    toggleSelection(img.id)
  } else {
    // Default mode: open preview/edit modal
    openPreview(img)
  }
}}
```

### Modal Actions:
```typescript
// UPDATE - Changes metadata only, image_url unchanged
handleSaveEdit() {
  await supabase
    .from("gallery")
    .update({ title, description, category })
    .eq("id", imageId)
}

// DELETE - Removes from storage AND database
handleDeleteSingle(img) {
  const fileName = img.image_url.split('/').pop()
  await supabase.storage.from("gallery-images").remove([fileName])
  await supabase.from("gallery").delete().eq("id", img.id)
}
```

### Bulk Delete:
```typescript
handleDeleteSelected() {
  const imagesToDelete = images.filter(img => selectedImages.has(img.id))
  
  // Delete each from storage and database
  await Promise.all(imagesToDelete.map(async (img) => {
    const fileName = img.image_url.split('/').pop()
    await supabase.storage.from("gallery-images").remove([fileName])
    await supabase.from("gallery").delete().eq("id", img.id)
  }))
  
  setSelectMode(false) // Exit select mode
}
```

---

## âœ… Requirements Met

1. âœ… **DEFAULT MODE:** Clicking image opens preview (not selection)
2. âœ… **SELECT MODE:** Checkboxes only appear when explicitly enabled
3. âœ… **EDIT:** Full UPDATE functionality for metadata
4. âœ… **DELETE:** Single delete from modal
5. âœ… **BULK DELETE:** Multi-select and delete in select mode
6. âœ… **STORAGE CLEANUP:** All deletes remove both DB row and storage file
7. âœ… **IMAGE URL:** Never changes during update (no re-upload)

---

## ðŸŽ¨ Visual Indicators

### Image Border States:
- **Default:** Gray border (`border-gray-200`)
- **Hover:** Darker gray (`hover:border-gray-300`)
- **Selected (in select mode):** Teal border + ring (`border-teal-500 ring-2 ring-teal-200`)

### Buttons:
- **Select Multiple:** Blue (`bg-blue-600`)
- **Delete Selected:** Red (`bg-red-600`)
- **Save Changes:** Teal (`bg-teal-600`)
- **Cancel Selection:** Gray (`bg-gray-200`)

---

## ðŸš€ User Experience Flow

### Scenario 1: Edit Single Image
1. User sees gallery in default mode
2. Clicks image â†’ Modal opens
3. Edits title/description/category
4. Clicks "Save Changes"
5. Success! Image updated, modal closes

### Scenario 2: Delete Single Image
1. User clicks image â†’ Modal opens
2. Clicks "Delete Image"
3. Confirms deletion
4. Success! Image removed, modal closes

### Scenario 3: Bulk Delete
1. User clicks "Select Multiple"
2. Interface switches to select mode
3. User clicks 3 images (checkboxes appear)
4. Clicks "Delete Selected (3)"
5. Confirms deletion
6. Success! All 3 images removed, mode exits

### Scenario 4: Cancel Selection
1. User in select mode
2. Realizes they don't want to delete
3. Clicks "Cancel Selection"
4. Returns to default mode, checkboxes hidden

---

**The gallery manager now provides an intuitive, professional experience!**
